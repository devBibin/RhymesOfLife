{% extends 'base.html' %}
{% load i18n static %}

{% block content %}
<div class="container py-5">
  <div class="row justify-content-center">
    <div class="col-md-8">
      <div class="card shadow-sm">
        <div class="card-body">
          <h1 class="h4 mb-3">{% trans "Ask for help" %}</h1>

          <p class="mb-4">
            {% trans "If you need support or assistance, you can request help from our partner fund. Describe below what you need and leave contact details so we can follow up." %}
          </p>

          <a href="{{ fund_url }}" target="_blank" rel="noopener noreferrer" class="btn btn-outline-primary mb-4">
            {% trans "Go to the fund website" %}
          </a>

          {% if messages %}
            {% for m in messages %}
              <div class="alert alert-{{ m.tags }}">{{ m }}</div>
            {% endfor %}
          {% endif %}

          <form method="post" novalidate>
            {% csrf_token %}

            <div class="mb-3">
              <label class="form-label">{% trans "Username" %}</label>
              <input class="form-control" type="text" value="{{ values.username }}" readonly>
              <div class="form-text">{% trans "Your account username will be attached to the request." %}</div>
            </div>

            <div class="mb-3">
              <label for="hr-full-name" class="form-label">{% trans "Full name" %}</label>
              <input id="hr-full-name"
                     class="form-control"
                     name="full_name" type="text" value="{{ values.full_name }}">
            </div>

            {% if has_tg %}
              <div class="mb-3">
                <label class="form-label">{% trans "Telegram" %}</label>
                <input class="form-control" type="text" value="{{ values.telegram }}" readonly>
                <div class="form-text">{% trans "Telegram is connected to your account." %}</div>
              </div>
            {% else %}
              <div class="mb-3">
                <label for="hr-telegram" class="form-label">{% trans "Telegram (optional)" %}</label>
                <input id="hr-telegram"
                       class="form-control{% if errors.telegram %} is-invalid{% endif %}"
                       name="telegram" type="text" placeholder="@username"
                       value="{{ values.telegram }}">
                {% if errors.telegram %}
                  <div class="invalid-feedback d-block">{{ errors.telegram }}</div>
                {% else %}
                  <div class="form-text">{% trans "Provide your Telegram handle so we can contact you faster." %}</div>
                {% endif %}
              </div>
            {% endif %}

            <div class="mb-3">
              <label for="hr-email" class="form-label">{% trans "Email (optional)" %}</label>
              <input id="hr-email"
                     class="form-control{% if errors.email %} is-invalid{% endif %}"
                     name="email" type="email" value="{{ values.email }}">
              {% if errors.email %}
                <div class="invalid-feedback d-block">{{ errors.email }}</div>
              {% endif %}
            </div>

            <div class="mb-3">
              <label for="hr-phone" class="form-label">{% trans "Phone" %}</label>
              <input id="hr-phone"
                     class="form-control"
                     name="phone" type="text" value="{{ values.phone }}">
            </div>

            <div class="mb-3">
              <label for="hr-birth" class="form-label">{% trans "Birth date" %}</label>
              <input id="hr-birth"
                     class="form-control{% if errors.birth_date %} is-invalid{% endif %}"
                     name="birth_date" type="date" value="{{ values.birth_date }}">
              {% if errors.birth_date %}
                <div class="invalid-feedback d-block">{{ errors.birth_date }}</div>
              {% endif %}
            </div>

            <div class="mb-3">
              <label for="hr-city" class="form-label">{% trans "City" %}</label>
              <input id="hr-city"
                     class="form-control"
                     name="city" type="text" value="{{ values.city }}">
            </div>

            <div class="mb-3">
              <label for="hr-syndrome" class="form-label">{% trans "Syndrome" %}</label>
              <input id="hr-syndrome"
                     class="form-control"
                     name="syndrome" type="text" value="{{ values.syndrome }}">
            </div>

            <div class="mb-3">
              <label for="hr-gen" class="form-label">{% trans "Gen" %}</label>
              <textarea id="hr-gen"
                        class="form-control"
                        name="gen" rows="3">{{ values.gen }}</textarea>
            </div>

            <div class="mb-3">
              <label for="hr-meds" class="form-label">{% trans "Medications" %}</label>
              <textarea id="hr-meds"
                        class="form-control"
                        name="medications" rows="3">{{ values.medications }}</textarea>
            </div>

            <div class="mb-3">
              <label for="hr-message" class="form-label">{% trans "What do you need?" %}</label>
              <textarea id="hr-message"
                        class="form-control{% if errors.message %} is-invalid{% endif %}"
                        name="message" rows="6"
                        placeholder="{% trans "Describe what you need..." %}">{{ values.message }}</textarea>
              {% if errors.message %}
                <div class="invalid-feedback d-block">{{ errors.message }}</div>
              {% endif %}
            </div>

            <button type="submit" class="btn btn-primary">{% trans "Send request" %}</button>
          </form>

          <hr>
          <small class="text-muted">
            {% trans "By sending you agree that volunteers may contact you to clarify details." %}
          </small>
        </div>
      </div>
    </div>
  </div>
</div>
{% endblock %}
