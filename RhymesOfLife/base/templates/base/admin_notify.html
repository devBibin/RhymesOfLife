{% extends "base.html" %}
{% load i18n static %}

{% block title %}{% trans "Send notifications" %}{% endblock %}

{% block content %}
<div class="row justify-content-center">
  <div class="col-lg-7">
    <div class="card shadow-sm">
      <div class="card-header">
        <strong>{% trans "Send notifications" %}</strong>
      </div>
      <div class="card-body">
        <div class="mb-3">
          <label class="form-label" for="scope">{% trans "Scope" %}</label>
          <select id="scope" class="form-select">
            <option value="personal">{% trans "Personal" %}</option>
            <option value="broadcast">{% trans "Broadcast" %}</option>
          </select>
        </div>

        <div class="mb-3" id="recipient-wrap">
          <label class="form-label" for="recipient_username">{% trans "Recipient" %}</label>
          <input id="recipient_username" type="text" class="form-control" list="user_suggest"
                 placeholder="{% trans 'Enter username' %}" autocomplete="off">
          <datalist id="user_suggest"></datalist>
          <div class="form-text">{% trans "Start typing a username and pick from suggestions." %}</div>

          <div class="mt-3">
            <label class="form-label" for="recipient_id">{% trans "Recipient ID (optional)" %}</label>
            <input id="recipient_id" type="number" class="form-control" placeholder="{% trans 'Enter AdditionalUserInfo ID' %}">
          </div>
          <input type="hidden" id="recipient_id_auto">
          <div class="form-text">{% trans "Either username or ID is required for personal scope." %}</div>
        </div>

        <div class="mb-3">
          <label class="form-label" for="type">{% trans "Type" %}</label>
          <select id="type" class="form-select">
            <option value="ADMIN_MESSAGE">{% trans "Admin message" %}</option>
            <option value="SYSTEM_MESSAGE">{% trans "System message" %}</option>
          </select>
        </div>

        <div class="mb-3">
          <label class="form-label" for="title">{% trans "Title" %}</label>
          <input id="title" type="text" class="form-control" maxlength="140" placeholder="{% trans 'Optional' %}">
        </div>

        <div class="mb-3">
          <label class="form-label" for="message">{% trans "Message" %}</label>
          <textarea id="message" class="form-control" rows="4" placeholder="{% trans 'Enter message' %}"></textarea>
        </div>

        <div class="mb-3">
          <label class="form-label" for="url">{% trans "Link (optional)" %}</label>
          <input id="url" type="url" class="form-control" placeholder="https://">
        </div>

        <div class="d-flex gap-2">
          <button id="send" class="btn btn-primary">{% trans "Send" %}</button>
          <a class="btn btn-outline-secondary" href="{% url 'home' %}">{% trans "Cancel" %}</a>
        </div>

        <div id="result" class="mt-3"></div>
      </div>
    </div>
  </div>
</div>
{% endblock %}

{% block extra_js %}
<script>
  window.ADMIN_NOTIFY_CFG = {
    apiUrl: "{% url 'admin_notify_api' %}",
    suggestUrl: "{% url 'admin_user_suggest' %}"
  };
</script>
<script src="{% static 'js/admin_notify.js' %}" defer></script>
{% endblock %}
