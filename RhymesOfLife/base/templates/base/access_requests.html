{% extends "base.html" %}
{% load i18n %}

{% block title %}{% trans "Access requests" %}{% endblock %}

{% block content %}
<div class="container py-4">
  <h1 class="mb-4">{% trans "Access requests" %}</h1>

  {% if requests %}
    <div class="list-group">
      {% for r in requests %}
        <div class="list-group-item">
          <div class="d-flex justify-content-between align-items-center">
            <div class="fw-semibold">
              {{ r.doctor.user.get_full_name|default:r.doctor.user.username }}
            </div>
            <small class="text-muted">{{ r.created_at|date:"d.m.Y H:i" }}</small>
          </div>
          <div class="text-muted small mb-2">
            {% trans "Status" %}: {{ r.get_status_display }}
          </div>

          {% if r.status == "pending" %}
            <div class="d-flex gap-2">
              <form method="post" action="{% url 'access_request_decide' r.id %}">
                {% csrf_token %}
                <input type="hidden" name="action" value="approve">
                <button type="submit" class="btn btn-success btn-sm">
                  {% trans "Approve" %}
                </button>
              </form>
              <form method="post" action="{% url 'access_request_decide' r.id %}">
                {% csrf_token %}
                <input type="hidden" name="action" value="deny">
                <button type="submit" class="btn btn-outline-danger btn-sm">
                  {% trans "Deny" %}
                </button>
              </form>
            </div>
          {% else %}
            <div class="text-muted small">{% trans "Decision sent." %}</div>
          {% endif %}
        </div>
      {% endfor %}
    </div>
  {% else %}
    <div class="alert alert-info">{% trans "No access requests." %}</div>
  {% endif %}
</div>
{% endblock %}
