{% extends "base.html" %}
{% load i18n static %}

{% block title %}{% trans "My health" %} â€” {{ block.super }}{% endblock %}

{% block content %}
<style>
  .topbar{display:flex;align-items:center;justify-content:space-between;margin-bottom:1rem}
  .subtext{color:var(--bs-secondary-color);font-size:.925rem}

  #drop-zone{transition:.15s;cursor:pointer}
  #drop-zone.dragover,#drop-zone.border-primary{background:rgba(13,110,253,.06)}
  .file-card{display:flex;gap:.75rem;align-items:center}
  .link-item{display:flex;gap:.5rem;align-items:center;margin-top:.5rem}
  .link-item input[type=url]{flex:1}
  .tab-content{backdrop-filter:saturate(1.2) blur(2px)}

  .nav-modern{display:flex;flex-wrap:wrap;gap:.5rem}
  .nav-modern .nav-link{
    display:inline-flex;align-items:center;gap:.45rem;
    border:0;border-radius:999px;padding:.5rem .9rem;
    font-weight:500;color:var(--bs-body-color);opacity:.9
  }
  .nav-modern .nav-link:hover{opacity:1;background:rgba(0,0,0,.04)}
  .nav-modern .nav-link.active{
    opacity:1;background:rgba(var(--bs-primary-rgb),.12);
    color:var(--bs-primary);box-shadow:inset 0 0 0 1px rgba(var(--bs-primary-rgb),.25)
  }
  .nav-modern .nav-link .bi{font-size:1rem}

  @media (max-width:576px){
    #drop-zone{padding:1.5rem 1rem}
    .file-card{flex-direction:column;align-items:flex-start}
    .file-card span{margin-bottom:.5rem}

    .nav-modern{gap:.5rem}
    .nav-modern .nav-item{flex:1 1 0}
    .nav-modern .nav-link{
      width:100%;
      justify-content:center;
      padding:.75rem 0;
      border-radius:14px
    }
    .nav-modern .nav-link .label{display:none}
    .nav-modern .nav-link .bi{font-size:1.25rem;margin:0}
  }
</style>

<div class="container py-4">
  <div class="topbar">
    <h1 class="h4 mb-0">{% trans "My health" %}</h1>
  </div>

  <ul class="nav nav-pills nav-modern mb-3" id="healthTabs" role="tablist">
    <li class="nav-item" role="presentation">
      <button
        class="nav-link active"
        id="tab-wellness"
        data-bs-toggle="tab"
        data-bs-target="#pane-wellness"
        type="button"
        role="tab"
        aria-controls="pane-wellness"
        aria-selected="true"
        aria-label="{% trans 'Wellness' %}"
        title="{% trans 'Wellness' %}">
        <i class="bi bi-activity"></i><span class="label">{% trans "Wellness" %}</span>
      </button>
    </li>
    <li class="nav-item" role="presentation">
      <button
        class="nav-link"
        id="tab-exams"
        data-bs-toggle="tab"
        data-bs-target="#pane-exams"
        type="button"
        role="tab"
        aria-controls="pane-exams"
        aria-selected="false"
        aria-label="{% trans 'Examinations' %}"
        title="{% trans 'Examinations' %}">
        <i class="bi bi-file-earmark-medical"></i><span class="label">{% trans "Examinations" %}</span>
      </button>
    </li>
    <li class="nav-item" role="presentation">
      <button
        class="nav-link"
        id="tab-comments"
        data-bs-toggle="tab"
        data-bs-target="#pane-comments"
        type="button"
        role="tab"
        aria-controls="pane-comments"
        aria-selected="false"
        aria-label="{% trans "Doctor's comments" %}"
        title="{% trans "Doctor's comments" %}">
        <i class="bi bi-chat-dots"></i><span class="label">{% trans "Doctor's comments" %}</span>
      </button>
    </li>
  </ul>

  <div class="tab-content rounded-4 border p-3 shadow-sm bg-white">
    <div id="pane-wellness" class="tab-pane fade show active" role="tabpanel" aria-labelledby="tab-wellness">
      <div class="text-center py-5" data-loader>
        <div class="spinner-border" role="status" aria-hidden="true"></div>
      </div>
    </div>
    <div id="pane-exams" class="tab-pane fade" role="tabpanel" aria-labelledby="tab-exams">
      <div class="text-center py-5" data-loader>
        <div class="spinner-border" role="status" aria-hidden="true"></div>
      </div>
    </div>
    <div id="pane-comments" class="tab-pane fade" role="tabpanel" aria-labelledby="tab-comments">
      <div class="text-center py-5" data-loader>
        <div class="spinner-border" role="status" aria-hidden="true"></div>
      </div>
    </div>
  </div>
</div>

<link rel="stylesheet" href="{% static 'css/new_styles.css' %}">

<script>
  window.MY_HEALTH_CFG = {
    endpoints: {
      exams: "{% url 'health_documents_partial' %}",
      recs: "{% url 'health_recommendations_partial' %}",
      wellness: "{% url 'health_wellness_partial' %}",
      apiEntries: "{% url 'wellness_entries_api' %}",
      apiSettings: "{% url 'wellness_settings_api' %}",
      examsCreate: "{% url 'my_documents' %}",
      examApiPattern: "{% url 'exam_detail_api' 0 %}",
      docDeletePattern: "{% url 'delete_document_api' 0 %}",
    },
    i18n: {
      failedLoad: "{% trans 'Failed to load. Please try again.' %}",
      wellnessLabel: "{% trans 'Wellness' %}",
      score: "{% trans 'Score' %}",
      pasteLink: "{% trans 'Paste link' %}",
      removeLink: "{% trans 'Remove link' %}",
      removeFile: "{% trans 'Remove file' %}",
      pleaseDate: "{% trans 'Please specify the exam date.' %}",
      failedSave: "{% trans 'Failed to save.' %}",
      networkError: "{% trans 'Network error.' %}",
      unableLoad: "{% trans 'Unable to load data.' %}",
      deleteExamQ: "{% trans 'Delete this exam?' %}",
      deletionFailed: "{% trans 'Deletion failed.' %}",
      deleteFileQ: "{% trans 'Delete this file?' %}",
      unsupportedTypeTpl: "{% blocktrans %}Unsupported file type: %(name)s{% endblocktrans %}",
    }
  };
</script>

<script src="{% static 'js/my_health.js' %}"></script>
{% endblock %}
