{% extends "base.html" %}
{% load static i18n %}

{% block content %}
<link rel="stylesheet" href="{% static 'css/new_styles.css' %}">
<div class="container py-4">
  <h2 class="mb-4">ðŸ©º {% trans "Patient wellness" %}: {{ patient.get_full_name|default:patient.username }}</h2>
  <div class="card shadow-sm mb-4">
    <div class="card-body">
      <canvas id="chart" height="120"></canvas>
    </div>
  </div>
  <div class="card shadow-sm">
    <div class="card-body">
      <h5 class="mb-3">{% trans "Entries" %}</h5>
      {% if entries %}
        <ul class="list-group">
          {% for e in entries %}
            <li class="list-group-item d-flex justify-content-between align-items-center">
              <div><strong>{{ e.date }}</strong> Â· {% trans "Score" %}: {{ e.score }}</div>
              <div class="text-muted">{{ e.note }}</div>
            </li>
          {% endfor %}
        </ul>
      {% else %}
        <div class="alert alert-info mb-0">{% trans "No entries yet." %}</div>
      {% endif %}
    </div>
  </div>
</div>

<script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.0/dist/chart.umd.min.js"></script>
<script>
const data = {{ entries|safe }};
const labels = data.map(i => i.date);
const values = data.map(i => i.score);
const ctx = document.getElementById("chart").getContext("2d");
new Chart(ctx, {
  type: "line",
  data: { labels, datasets: [{ label: "{{ _('Wellness') }}", data: values, tension: 0.25, fill: false }] },
  options: { scales: { y: { min: 1, max: 10, ticks: { stepSize: 1 } } } }
});
</script>
{% endblock %}
