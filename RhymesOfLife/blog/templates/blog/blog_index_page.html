{% extends "base.html" %}
{% load wagtailcore_tags wagtailimages_tags static i18n %}

{% block content %}
<link rel="stylesheet" href="{% static 'css/articles.css' %}">

<div class="container py-4 rl-page">
  <div class="rl-page__head">
    <div>
      <h1 class="rl-page__title">{% trans "Articles" %}</h1>
    </div>

    {% if request.user.is_staff %}
      <a href="{% url 'create_article' %}" class="btn btn-primary btn-sm">
        <i class="bi bi-pencil-square me-1" aria-hidden="true"></i>{% trans "New article" %}
      </a>
    {% endif %}
  </div>

  <form id="search-form" class="rl-toolbar" novalidate>
    <div class="rl-search">
      <div class="input-group">
        <input
          id="search-input"
          name="q"
          type="text"
          class="form-control"
          placeholder="{% trans 'Search by title, author or tags' %}"
          value="{{ query }}"
          autocomplete="off"
        >
        <button type="submit" class="btn btn-outline-secondary">
          <i class="bi bi-search me-1" aria-hidden="true"></i>{% trans "Search" %}
        </button>
      </div>
    </div>

    <input type="hidden" id="current-sort" name="sort" value="{{ sort|default:'date' }}">

    <div class="rl-segmented" role="tablist" aria-label="{% trans 'Sort' %}">
      <button
        type="button"
        class="rl-segmented__item {% if sort|default:'date' == 'date' %}is-active{% endif %}"
        data-sort="date"
        aria-pressed="{% if sort|default:'date' == 'date' %}true{% else %}false{% endif %}">
        {% trans "Newest" %}
      </button>
      <button
        type="button"
        class="rl-segmented__item {% if sort == 'popular' %}is-active{% endif %}"
        data-sort="popular"
        aria-pressed="{% if sort == 'popular' %}true{% else %}false{% endif %}">
        {% trans "Most popular" %}
      </button>
    </div>
  </form>

  <div id="posts-container" data-api="{% url 'ajax_article_search' %}">
    {% include "blog/includes/article_list_fragment.html" with sort=sort query=query %}
  </div>
</div>
{% endblock content %}
